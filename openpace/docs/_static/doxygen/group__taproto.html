<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenPACE: Protocol Steps for Terminal Authentication</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenPACE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Protocol Steps for Terminal Authentication<div class="ingroups"><a class="el" href="group__eacproto.html">Protocol Steps for Extended Access Control</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga3b9f3dfea8560bd63e9594d32994bd95"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__taproto.html#ga3b9f3dfea8560bd63e9594d32994bd95">TA_disable_checks</a> (<a class="el" href="eac_8h.html#ae9b1b2593999b3c1b8eb10a4629b7c94">EAC_CTX</a> *ctx)</td></tr>
<tr class="memdesc:ga3b9f3dfea8560bd63e9594d32994bd95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables <code>TA_FLAG_SKIP_TIMECHECK</code> in the TA context.  <a href="#ga3b9f3dfea8560bd63e9594d32994bd95">More...</a><br /></td></tr>
<tr class="separator:ga3b9f3dfea8560bd63e9594d32994bd95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga042883976e7a3423db2f99f6501272a7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__taproto.html#ga042883976e7a3423db2f99f6501272a7">TA_STEP2_import_certificate</a> (const <a class="el" href="eac_8h.html#ae9b1b2593999b3c1b8eb10a4629b7c94">EAC_CTX</a> *ctx, const unsigned char *cert, size_t cert_len)</td></tr>
<tr class="memdesc:ga042883976e7a3423db2f99f6501272a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Imports a CV Certificate to the EAC context.  <a href="#ga042883976e7a3423db2f99f6501272a7">More...</a><br /></td></tr>
<tr class="separator:ga042883976e7a3423db2f99f6501272a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1d7bcb63f5a375759d9d040c200068c3"><td class="memItemLeft" align="right" valign="top">BUF_MEM *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__taproto.html#ga1d7bcb63f5a375759d9d040c200068c3">TA_STEP3_generate_ephemeral_key</a> (const <a class="el" href="eac_8h.html#ae9b1b2593999b3c1b8eb10a4629b7c94">EAC_CTX</a> *ctx)</td></tr>
<tr class="memdesc:ga1d7bcb63f5a375759d9d040c200068c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates ephemeral key for CA.  <a href="#ga1d7bcb63f5a375759d9d040c200068c3">More...</a><br /></td></tr>
<tr class="separator:ga1d7bcb63f5a375759d9d040c200068c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1a4d4534bb23c4d2ffefb5bfdec335ff"><td class="memItemLeft" align="right" valign="top">BUF_MEM *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__taproto.html#ga1a4d4534bb23c4d2ffefb5bfdec335ff">TA_STEP4_get_nonce</a> (const <a class="el" href="eac_8h.html#ae9b1b2593999b3c1b8eb10a4629b7c94">EAC_CTX</a> *ctx)</td></tr>
<tr class="memdesc:ga1a4d4534bb23c4d2ffefb5bfdec335ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a nonce for the PCD.  <a href="#ga1a4d4534bb23c4d2ffefb5bfdec335ff">More...</a><br /></td></tr>
<tr class="separator:ga1a4d4534bb23c4d2ffefb5bfdec335ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga65d4a5c270c5071b7bc7bce3ab189cda"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__taproto.html#ga65d4a5c270c5071b7bc7bce3ab189cda">TA_STEP4_set_nonce</a> (const <a class="el" href="eac_8h.html#ae9b1b2593999b3c1b8eb10a4629b7c94">EAC_CTX</a> *ctx, const BUF_MEM *nonce)</td></tr>
<tr class="memdesc:ga65d4a5c270c5071b7bc7bce3ab189cda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Import the nonce from the PICC.  <a href="#ga65d4a5c270c5071b7bc7bce3ab189cda">More...</a><br /></td></tr>
<tr class="separator:ga65d4a5c270c5071b7bc7bce3ab189cda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga31712e0ebf291f0f31cd462f33a0d802"><td class="memItemLeft" align="right" valign="top">BUF_MEM *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__taproto.html#ga31712e0ebf291f0f31cd462f33a0d802">TA_STEP5_sign</a> (const <a class="el" href="eac_8h.html#ae9b1b2593999b3c1b8eb10a4629b7c94">EAC_CTX</a> *ctx, const BUF_MEM *my_ta_eph_pubkey, const BUF_MEM *opp_pace_eph_pubkey, const BUF_MEM *auxdata)</td></tr>
<tr class="memdesc:ga31712e0ebf291f0f31cd462f33a0d802"><td class="mdescLeft">&#160;</td><td class="mdescRight">Signs data for terminal authentication.  <a href="#ga31712e0ebf291f0f31cd462f33a0d802">More...</a><br /></td></tr>
<tr class="separator:ga31712e0ebf291f0f31cd462f33a0d802"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga76fe96c3ba3d1ed684f08e8d486d2f2b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__taproto.html#ga76fe96c3ba3d1ed684f08e8d486d2f2b">TA_STEP6_verify</a> (const <a class="el" href="eac_8h.html#ae9b1b2593999b3c1b8eb10a4629b7c94">EAC_CTX</a> *ctx, const BUF_MEM *opp_ta_comp_eph_pubkey, const BUF_MEM *my_pace_comp_eph_pubkey, const BUF_MEM *auxdata, const BUF_MEM *signature)</td></tr>
<tr class="memdesc:ga76fe96c3ba3d1ed684f08e8d486d2f2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies PCD's signature from TA step 5.  <a href="#ga76fe96c3ba3d1ed684f08e8d486d2f2b">More...</a><br /></td></tr>
<tr class="separator:ga76fe96c3ba3d1ed684f08e8d486d2f2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga3b9f3dfea8560bd63e9594d32994bd95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3b9f3dfea8560bd63e9594d32994bd95">&#9670;&nbsp;</a></span>TA_disable_checks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TA_disable_checks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="eac_8h.html#ae9b1b2593999b3c1b8eb10a4629b7c94">EAC_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables <code>TA_FLAG_SKIP_TIMECHECK</code> in the TA context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>EAC context for which to disable TA checks </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga042883976e7a3423db2f99f6501272a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga042883976e7a3423db2f99f6501272a7">&#9670;&nbsp;</a></span>TA_STEP2_import_certificate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TA_STEP2_import_certificate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="eac_8h.html#ae9b1b2593999b3c1b8eb10a4629b7c94">EAC_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>cert_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Imports a CV Certificate to the EAC context. </p>
<p>This function should be used to subsequently verify all certificates of a certificate chain. The signature and date of the certificate are verified using the trust anchor or the most recently imported certificate. The TA context is adjusted to use domain parameters of the imported certificate. If the chain contains a new trust anchor (i.e. a CVCA certificate), the old trust anchor is replaced when EAC is completed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>EAC context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cert</td><td>raw Certificate to import </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cert_len</td><td>Length of <em>cert</em> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success or 0 in case of an error</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="http://frankmorgner.github.io/openpace/protocols.html#id3">TA's Protocol Specification</a> </dd></dl>

</div>
</div>
<a id="ga1d7bcb63f5a375759d9d040c200068c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1d7bcb63f5a375759d9d040c200068c3">&#9670;&nbsp;</a></span>TA_STEP3_generate_ephemeral_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BUF_MEM* TA_STEP3_generate_ephemeral_key </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="eac_8h.html#ae9b1b2593999b3c1b8eb10a4629b7c94">EAC_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates ephemeral key for CA. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>EAC context. The CA context of <em>ctx</em> is initialized for key agreement</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Ephemeral public key or NULL in case of an error</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="http://frankmorgner.github.io/openpace/protocols.html#id3">TA's Protocol Specification</a> </dd></dl>

</div>
</div>
<a id="ga1a4d4534bb23c4d2ffefb5bfdec335ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1a4d4534bb23c4d2ffefb5bfdec335ff">&#9670;&nbsp;</a></span>TA_STEP4_get_nonce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BUF_MEM* TA_STEP4_get_nonce </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="eac_8h.html#ae9b1b2593999b3c1b8eb10a4629b7c94">EAC_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a nonce for the PCD. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>EAC context. The nonce is saved in <em>ctx</em> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Nonce or NULL in case of an error</dd></dl>
<dl class="section note"><dt>Note</dt><dd>EAC_CTX_init_ca must have been called before the nonce can be generated</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="http://frankmorgner.github.io/openpace/protocols.html#id3">TA's Protocol Specification</a> </dd></dl>

</div>
</div>
<a id="ga65d4a5c270c5071b7bc7bce3ab189cda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga65d4a5c270c5071b7bc7bce3ab189cda">&#9670;&nbsp;</a></span>TA_STEP4_set_nonce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TA_STEP4_set_nonce </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="eac_8h.html#ae9b1b2593999b3c1b8eb10a4629b7c94">EAC_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BUF_MEM *&#160;</td>
          <td class="paramname"><em>nonce</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Import the nonce from the PICC. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>EAC context. The nonce is saved in <em>ctx</em> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nonce</td><td>The nonce to be copied</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success or 0 in case of an error</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="http://frankmorgner.github.io/openpace/protocols.html#id3">TA's Protocol Specification</a> </dd></dl>

</div>
</div>
<a id="ga31712e0ebf291f0f31cd462f33a0d802"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga31712e0ebf291f0f31cd462f33a0d802">&#9670;&nbsp;</a></span>TA_STEP5_sign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BUF_MEM* TA_STEP5_sign </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="eac_8h.html#ae9b1b2593999b3c1b8eb10a4629b7c94">EAC_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BUF_MEM *&#160;</td>
          <td class="paramname"><em>my_ta_eph_pubkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BUF_MEM *&#160;</td>
          <td class="paramname"><em>opp_pace_eph_pubkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BUF_MEM *&#160;</td>
          <td class="paramname"><em>auxdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Signs data for terminal authentication. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>EAC context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">my_ta_eph_pubkey</td><td>PCD's ephemeral public key generated in Step 3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">opp_pace_eph_pubkey</td><td>PICC's ephemeral public key generated in PACE Step 3b </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">auxdata</td><td>(optional) Auxiliary data from PCD</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Signature or NULL in case of an error</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="http://frankmorgner.github.io/openpace/protocols.html#id3">TA's Protocol Specification</a> </dd></dl>

</div>
</div>
<a id="ga76fe96c3ba3d1ed684f08e8d486d2f2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga76fe96c3ba3d1ed684f08e8d486d2f2b">&#9670;&nbsp;</a></span>TA_STEP6_verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TA_STEP6_verify </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="eac_8h.html#ae9b1b2593999b3c1b8eb10a4629b7c94">EAC_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BUF_MEM *&#160;</td>
          <td class="paramname"><em>opp_ta_comp_eph_pubkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BUF_MEM *&#160;</td>
          <td class="paramname"><em>my_pace_comp_eph_pubkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BUF_MEM *&#160;</td>
          <td class="paramname"><em>auxdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BUF_MEM *&#160;</td>
          <td class="paramname"><em>signature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifies PCD's signature from TA step 5. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>EAC context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">opp_ta_comp_eph_pubkey</td><td>PCD's compressed ephemeral public key generated in Step 3 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">my_pace_comp_eph_pubkey</td><td>PICC's compressed ephemeral public key generated in PACE Step 3b </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">auxdata</td><td>(optional) Auxiliary data from PCD </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature</td><td>Data to verify</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if the signature has been verified, 0 if not or -1 in case of an error</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="http://frankmorgner.github.io/openpace/protocols.html#id3">TA's Protocol Specification</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
